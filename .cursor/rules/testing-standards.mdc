---
globs: **/*.test.ts,**/*.spec.ts
description: "Стандарты тестирования"
---

# Стандарты тестирования

## Именование тестов:
- Используйте формат: "When <условие>, <ожидаемый результат>"
- Пример: "When device location data changes, updates device location"
- Группируйте тесты по функциональности

## Структура тестов:
- Используйте describe для группировки связанных тестов
- Используйте it или test для отдельных тестовых случаев
- Добавляйте beforeEach/afterEach для настройки и очистки

## Моки и стабы:
- Мокайте внешние зависимости (API, файловая система)
- Используйте jest.fn() для создания моков
- Тестируйте изолированно от внешних сервисов

## Покрытие:
- Стремитесь к высокому покрытию кода тестами
- Тестируйте как успешные, так и ошибочные сценарии
- Включайте edge cases в тесты

## Пример структуры:
```typescript
describe('LangChainService', () => {
  describe('parseInvoice', () => {
    it('When valid Excel file is provided, returns structured invoice data', async () => {
      // тест
    });
    
    it('When invalid file format is provided, throws error', async () => {
      // тест
    });
  });
});
```

## Асинхронные тесты:
- Используйте async/await в тестах
- Обрабатывайте промисы корректно
- Тестируйте таймауты и ошибки